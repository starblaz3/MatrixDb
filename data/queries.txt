LOAD DEPARTMENT
LOAD EMPLOYEE
LOAD PROJECT
LOAD WORKS_ON

TEMP <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM TEMP
CLEAR TEMP

TEMP <- PROJECT Ssn, Bdate, Super_ssn FROM EMPLOYEE
TEMPA <- CROSS TEMP TEMP
TEMPB <- SELECT TEMP2_Ssn == TEMP1_Super_ssn FROM TEMPA
TEMPC <- SELECT TEMP1_Bdate == TEMP2_Bdate FROM TEMPB
Q2 <- PROJECT TEMP1_Ssn, TEMP1_Super_ssn, TEMP1_Bdate FROM TEMPC
RENAME TEMP1_Ssn TO Ssn FROM Q2
RENAME TEMP1_Super_ssn TO Super_ssn FROM Q2
RENAME TEMP1_Bdate TO Bdate FROM Q2

TEMP <- CROSS EMPLOYEE, WORKS_ON
TEMPA <- SELECT Ssn == Essn FROM TEMP
TEMPB <- PROJECT Ssn, Pno, Sex FROM TEMPA
TEMPC <- CROSS TEMPB, TEMPB
TEMPD <- SELECT TEMPB1_Pno == TEMPB2_Pno FROM TEMPC
TEMPE <- SELECT TEMPB1_Sex != TEMPB2_Sex FROM TEMPD
Q3 <- PROJECT TEMPB1_Pno FROM TEMPE
RENAME TEMPB1_Pno TO Pno FROM Q3

TEMP <- CROSS EMPLOYEE, WORKS_ON
TEMPA <- SELECT Ssn == Essn FROM TEMP
TEMPB <- PROJECT Ssn, Pno, Super_ssn FROM TEMPA
TEMPC <- CROSS TEMPB, TEMPB
TEMPD <- SELECT TEMPB1_Pno == TEMPB2_Pno FROM TEMPC
TEMPE <- SELECT TEMPB1_Super_ssn == TEMPB2_Ssn FROM TEMPD
Q4 <- PROJECT TEMPB1_Ssn, TEMPB1_Super_ssn, TEMPB1_Pno FROM TEMPE
RENAME TEMPB1_Ssn TO Ssn FROM Q4
RENAME TEMPB1_Super_ssn TO Super_ssn FROM Q4
RENAME TEMPB1_Pno TO Pno FROM Q4

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
QUIT